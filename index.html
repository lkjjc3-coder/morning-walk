<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>ì•„ì¹¨ ì‚°ì±… ê¸°ë¡</title>
<style>
body {
  font-family: system-ui, sans-serif;
  background: #111;
  color: #fff;
  margin: 0;
  padding: 16px;
}

h1 {
  text-align: center;
  margin-bottom: 6px;
}

.subtitle {
  text-align: center;
  font-size: 14px;
  opacity: 0.8;
  margin-bottom: 20px;
}

nav {
  display: flex;
  justify-content: center;
  gap: 10px;
  margin-bottom: 24px;
}

nav button {
  background: #222;
  color: #fff;
  border: none;
  padding: 10px 18px;
  border-radius: 24px;
  cursor: pointer;
}

nav button.active {
  background: #4caf50;
}

.section { display: none; }
.section.active { display: block; }

.editor {
  max-width: 720px;
  margin: 0 auto 30px;
  background: #1c1c1c;
  padding: 16px;
  border-radius: 16px;
}

.preview {
  width: 100%;
  max-height: 360px;
  object-fit: contain;
  border-radius: 12px;
  background: #000;
  margin-bottom: 12px;
}

.editor textarea {
  width: 100%;
  min-height: 120px;
  background: #111;
  color: #fff;
  border: none;
  border-radius: 12px;
  padding: 12px;
  resize: vertical;
  margin-bottom: 12px;
}

.editor button {
  width: 100%;
  background: #4caf50;
  border: none;
  color: #fff;
  padding: 12px;
  border-radius: 12px;
  font-size: 15px;
  cursor: pointer;
}

.gallery {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
  gap: 16px;
}

.card {
  background: rgba(255,255,255,0.05);
  border-radius: 14px;
  padding: 10px;
}

.card img {
  width: 100%;
  border-radius: 10px;
}

.card .text {
  font-size: 14px;
  margin: 8px 0;
  opacity: 0.9;
}

.actions {
  display: flex;
  justify-content: space-between;
}

.actions button {
  background: #333;
  border: none;
  color: #fff;
  border-radius: 8px;
  padding: 4px 10px;
  cursor: pointer;
}
</style>
</head>
<body>

<h1>ğŸŒ… ì•„ì¹¨ ì‚°ì±… ê¸°ë¡</h1>
<div class="subtitle">ì•„ì¹¨ ì‚°ì±…ì²˜ëŸ¼ ê°€ë³ê²Œ ë‚¨ê¸°ëŠ” ë‚˜ì˜ ê¸°ë¡</div>

<nav>
  <button class="active" onclick="switchTab('walk', this)">ì‚°ì±…í•˜ê¸°</button>
  <button onclick="switchTab('meditation', this)">ë¬µìƒí•˜ê¸°</button>
  <button onclick="switchTab('record', this)">ê¸°ë¡í•˜ê¸°</button>
</nav>

<div id="walk" class="section active"></div>
<div id="meditation" class="section"></div>
<div id="record" class="section"></div>

<script>
const sections = ['walk','meditation','record'];

function switchTab(tab, btn) {
  sections.forEach(s => document.getElementById(s).classList.remove('active'));
  document.getElementById(tab).classList.add('active');
  document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
}

function initSection(key, title) {
  const container = document.getElementById(key);

  container.innerHTML = `
    <div class="editor">
      <h2>${title}</h2>
      <input type="file" accept="image/*" />
      <img class="preview" style="display:none" />
      <textarea placeholder="ê¸€ì„ ì²œì²œíˆ ë‚¨ê²¨ë³´ì„¸ìš”"></textarea>
      <button>ì €ì¥í•˜ê¸°</button>
    </div>
    <h3 style="max-width:720px;margin:0 auto 12px;opacity:.8">ğŸ“‚ ì €ì¥ëœ ê¸°ë¡</h3>
    <div class="gallery"></div>
  `;

  const input = container.querySelector('input');
  const preview = container.querySelector('.preview');
  const textarea = container.querySelector('textarea');
  const saveBtn = container.querySelector('button');
  const gallery = container.querySelector('.gallery');

  let data = JSON.parse(localStorage.getItem(key) || '[]');
  let tempImage = null;

  input.onchange = () => {
    if (!input.files[0]) return;
    const reader = new FileReader();
    reader.onload = e => {
      tempImage = e.target.result;
      preview.src = tempImage;
      preview.style.display = 'block';
    };
    reader.readAsDataURL(input.files[0]);
  };

  saveBtn.onclick = () => {
    if (!tempImage) {
      alert('ì‚¬ì§„ì„ ë¨¼ì € ì„ íƒí•˜ì„¸ìš”');
      return;
    }
    data.unshift({ img: tempImage, text: textarea.value, likes: 0 });
    localStorage.setItem(key, JSON.stringify(data));

    // ì´ˆê¸°í™”
    tempImage = null;
    preview.src = '';
    preview.style.display = 'none';
    textarea.value = '';
    input.value = '';

    render();
  };

  function render() {
    gallery.innerHTML = '';
    data.forEach((item, i) => {
      const card = document.createElement('div');
      card.className = 'card';
      card.innerHTML = `
        <img src="${item.img}" />
        <div class="text">${item.text || ''}</div>
        <div class="actions">
          <button onclick="like('${key}',${i})">ğŸ‘ ${item.likes}</button>
          <button onclick="del('${key}',${i})">ğŸ—‘</button>
        </div>
      `;
      gallery.appendChild(card);
    });
  }

  render();
}

function like(key, i) {
  const data = JSON.parse(localStorage.getItem(key) || '[]');
  if (!data[i]) return;
  data[i].likes++;
  localStorage.setItem(key, JSON.stringify(data));
  // í•´ë‹¹ ì„¹ì…˜ë§Œ ë‹¤ì‹œ ë Œë”
  initSection(key, key === 'walk' ? 'ì‚°ì±… ì‚¬ì§„ê³¼ ê¸°ë¡' : key === 'meditation' ? 'ë¬µìƒ ê¸°ë¡' : 'ì¼ìƒ ê¸°ë¡');
}

function del(key, i) {
  if (!confirm('ì‚­ì œí• ê¹Œìš”?')) return;
  const data = JSON.parse(localStorage.getItem(key) || '[]');
  if (!data[i]) return;
  data.splice(i,1);
  localStorage.setItem(key, JSON.stringify(data));
  // í•´ë‹¹ ì„¹ì…˜ë§Œ ë‹¤ì‹œ ë Œë”
  initSection(key, key === 'walk' ? 'ì‚°ì±… ì‚¬ì§„ê³¼ ê¸°ë¡' : key === 'meditation' ? 'ë¬µìƒ ê¸°ë¡' : 'ì¼ìƒ ê¸°ë¡');
}

initSection('walk','ì‚°ì±… ì‚¬ì§„ê³¼ ê¸°ë¡');
initSection('meditation','ë¬µìƒ ê¸°ë¡');
initSection('record','ì¼ìƒ ê¸°ë¡');
</script>

</body>
</html>
