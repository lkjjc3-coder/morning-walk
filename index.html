<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ì•„ì¹¨ ì‚°ì±… ê¸°ë¡</title>
<style>
/* ğŸŒ¿ ë”°ëœ»í•œ í†¤ ë””ìì¸ */
body {
  font-family: "Apple SD Gothic Neo", "Noto Sans KR", sans-serif;
  text-align: center;
  background: #2b2b2b;
  color: #f5f1ea;
  margin: 0;
  padding: 16px;
}

h1 { margin: 12px 0 6px; }

p.subtitle {
  opacity: 0.8;
  font-size: 14px;
  margin-bottom: 16px;
}

input[type="file"], textarea {
  width: 100%;
  max-width: 420px;
  margin: 6px auto;
  padding: 8px;
  border-radius: 8px;
  border: none;
}

#gallery {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
  gap: 12px;
}

.card {
  background: rgba(0,0,0,0.35);
  padding: 10px;
  border-radius: 14px;
}

.date-label {
  font-size: 12px;
  opacity: 0.7;
  margin-bottom: 4px;
}

.photo {
  width: 100%;
  aspect-ratio: 1 / 1;
  object-fit: cover;
  border-radius: 12px;
  cursor: pointer;
}

.memo {
  font-size: 14px;
  text-align: left;
  margin: 6px 0;
  opacity: 0.9;
}

.actions {
  display: flex;
  gap: 6px;
  margin-top: 4px;
}

.actions button {
  flex: 1;
  border: none;
  border-radius: 8px;
  padding: 6px;
  background: #6b5f4b;
  color: #fff;
}

.comment-input {
  width: 100%;
  margin-top: 6px;
  border-radius: 8px;
}

.comment {
  font-size: 13px;
  text-align: left;
  opacity: 0.85;
}

/* ğŸ–¼ ì´ë¯¸ì§€ ë·°ì–´ */
#viewer {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.85);
  z-index: 999;
  justify-content: center;
  align-items: center;
}

#viewer img {
  max-width: 92%;
  max-height: 92%;
  border-radius: 16px;
}

/* ğŸ“± ëª¨ë°”ì¼ ìµœì í™” */
@media (max-width: 600px) {
  h1 { font-size: 20px; }
}
</style>
</head>
<body>

<h1>ğŸŒ… ì•„ì¹¨ ì‚°ì±… ê¸°ë¡</h1>
<p class="subtitle">ì•„ì¹¨ ì‚°ì±…ì²˜ëŸ¼ ê°€ë³ê²Œ ë‚¨ê¸°ëŠ” ë‚˜ì˜ ê¸°ë¡</p>

<input type="file" id="photoInput" accept="image/*" multiple>
<textarea id="memoInput" placeholder="ì˜¤ëŠ˜ ì‚°ì±… ë¬µìƒì„ í•œ ì¤„ ë‚¨ê²¨ë³´ì„¸ìš”"></textarea>

<div id="gallery"></div>

<!-- ğŸ–¼ ì‚¬ì§„ í¬ê²Œ ë³´ê¸° -->
<div id="viewer" onclick="this.style.display='none'">
  <img id="viewerImg">
</div>

<script>
const fileInput = document.getElementById("photoInput");
const memoInput = document.getElementById("memoInput");
const gallery = document.getElementById("gallery");
const viewer = document.getElementById("viewer");
const viewerImg = document.getElementById("viewerImg");

const ADMIN_KEY = "morningwalk_admin";
let isAdmin = localStorage.getItem(ADMIN_KEY) === "yes";

let records = JSON.parse(localStorage.getItem("records") || "[]");

if (!isAdmin) {
  const pw = prompt("ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš” (ì·¨ì†Œí•˜ë©´ ë³´ê¸° ì „ìš©)");
  if (pw === "walk2026") {
    localStorage.setItem(ADMIN_KEY, "yes");
    isAdmin = true;
  }
}

fileInput.addEventListener("change", () => {
  const files = Array.from(fileInput.files);
  files.forEach(file => {
    if (!file.type.startsWith("image/")) return;
    const reader = new FileReader();
    reader.onload = e => {
      records.unshift({
        src: e.target.result,
        memo: memoInput.value,
        date: new Date().toISOString().slice(0,10),
        likes: 0,
        comments: []
      });
      memoInput.value = "";
      save(); render();
    };
    reader.readAsDataURL(file);
  });
  fileInput.value = "";
});

function save(){ localStorage.setItem("records", JSON.stringify(records)); }

function render(){
  gallery.innerHTML = "";
  records.forEach((r,i)=>{
    const card = document.createElement("div"); card.className="card";
    const date = document.createElement("div"); date.className="date-label"; date.textContent=r.date;
    const img = document.createElement("img"); img.className="photo"; img.src=r.src;
    img.onclick=()=>{ viewerImg.src=r.src; viewer.style.display="flex"; };
    const memo = document.createElement("div"); memo.className="memo"; memo.textContent=r.memo||"";

    const like = document.createElement("button"); like.textContent=`ğŸ‘ ${r.likes}`;
    like.onclick=()=>{ r.likes++; save(); render(); };

    const actions = document.createElement("div"); actions.className="actions"; actions.append(like);

    if(isAdmin){
      const del=document.createElement("button"); del.textContent="ì‚­ì œ";
      del.onclick=()=>{ if(confirm("ì‚­ì œí• ê¹Œìš”?")){ records.splice(i,1); save(); render(); }};
      actions.append(del);
    }

    card.append(date,img,memo,actions);
    gallery.append(card);
  });
}

render();
</script>
</body>
</html>
